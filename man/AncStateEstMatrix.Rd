% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AncStateEstMatrix.R
\name{AncStateEstMatrix}
\alias{AncStateEstMatrix}
\title{Ancestral State Estimation}
\usage{
AncStateEstMatrix(morph.matrix, tree, estimate.allchars = FALSE,
  estimate.tips = FALSE, uncertainty.threshold = 0)
}
\arguments{
\item{morph.matrix}{A character-taxon matrix in the format imported by \link{ReadMorphNexus}.}

\item{tree}{A tree (phylo object) with branch lengths that represents the relationships of the taxa in \code{morph.matrix}.}

\item{estimate.allchars}{An optional that allows the user to make estimates for all ancestral values. The default will only make estimates for nodes that link coded terminals.}

\item{estimate.tips}{An optional that allows the user to make estimates for tip values. The default only makes estimates for internal nodes.}

\item{uncertainty.threshold}{An optional value between 0 and 1 for transforming ancestral states estimations with a scaled likelihood below that value into NAs.}
}
\value{
\item{anc.lik.matrix}{A matrix of nodes (hypothetical ancestors; rows) against characters (columns) listing the reconstructed ancestral states.}
}
\description{
Given a tree and a cladistic matrix uses likelihood to estimate the ancestral states for every character.
}
\details{
Uses the \link{rerootingMethod} (Yang et al. 1995) as implemented in the \link{phytools} package to make ancestral state estimates. Here these are collapsed to the most likely state, or if two or more states are most likely, a polymorphism of the most likely states. This is the method used by Brusatte et al. (2014).
}
\examples{

# Set random seed:
set.seed(17)

# Generate a random tree for the Michaux data set:
tree <- rtree(nrow(Michaux1989$matrix))

# Update taxon names to match those in the data matrix:
tree$tip.label <- rownames(Michaux1989$matrix)

# Set root time by making youngest taxon extant:
tree$root.time <- max(diag(vcv(tree)))

# Estimate ancestral states:
AncStateEstMatrix(Michaux1989, tree)

}
\references{
Brusatte, S. L., Lloyd, G. T., Wang, S. C. and Norell, M. A., 2014. Gradual assembly of avian body plan culminated in rapid rates of evolution across dinosaur-bird transition. Current Biology, 24, 2386-2392.

Yang, Z., Kumar, S. and Nei, M., 1995. A new method of inference of ancestral nucleotide and amino acid sequences. Genetics, 141, 1641-1650.
}
\author{
Graeme T. Lloyd \email{graemetlloyd@gmail.com} and Thomas Guillerme \email{guillert@tcd.ie}
}
